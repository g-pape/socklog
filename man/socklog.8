.TH socklog 8
.SH NAME
socklog \- small and secure syslogd replacement for use with djb's daemontools
.SH SYNOPSIS
.B socklog
[
unix
] [
.I path
]
.br
.B socklog
inet [
.I ip
] [
.I port
]
.br
.B socklog
ucspi [
.I args
]
.SH DESCRIPTION
.B socklog
is run under daemontools'
.BR supervise (8),
writing syslog messages it receives from unix domain socket
.I path
or an inet udp socket
.I ip\fR:\fIport\fR
through a pipe provided by
.BR svscan (8)
to a
.BR multilog (8)
process.
.LP
.B socklog
can be run as an ucspi application to listen to an unix domain stream socket
and for more flexible distributed logging.
.LP
If the environment variables $UID and/or $GID are present,
.B socklog
will drop permissions to those ids after creating and binding the socket
(not in
.I ucspi
mode).
.LP
.B socklog
converts syslog facility and priority information to names
(\fIfacility\fR.\fIpriority\fR:)
as found in
.I /usr/include/syslog.h
at compile time if present.
.SH UNIX SOCKET
.B socklog
[
unix
] [
.I path
]
.LP
Starting
.B socklog
with the 1st argument
.IR unix ,
.B socklog
will listen to the unix domain socket
.IR path .
If
.I path
is omitted, the default
.I /dev/log
is used.
.LP
The 1st argument may be omitted, default is
.IR unix .
.SH INET SOCKET
.B socklog
inet [
.I ip
] [
.I port
]
.LP
Starting
.B socklog
with the 1st argument
.IR inet ,
.B socklog
will listen to the inet udp socket
.I ip\fR:\fIport\fR.
.LP
If
.I ip
starts with 0,
.B socklog
will bind to all local interfaces.
.LP
If
.I port
is less or equal 1024,
.B socklog
must be run by root.
.LP
.I port
may be omitted, default is 514.
.I ip
may be omitted, default is 0.
.LP
.B socklog
prepends
.I a.b.c.d:
to each syslog message it receives, where
.I a.b.c.d
is the ip address of the connecting system.
.SH UCSPI MODE
.B socklog
ucspi [
.I args
]
.LP
Starting
.B socklog
with the 1st argument
.IR ucspi ,
.B socklog
will run as an ucspi application. Normally
.B socklog
will only be started in
.I ucspi
mode by an ucspi server tool, such as
.BR tcpserver (1)
or
.BR unixserver .
.LP
For each
.IR arg ,
.B socklog
will prepend
$\fIarg\fR:
to each syslog message, if the environment variable
.RI $ arg
is present (maximum is 8).


.SH EXAMPLES
.I unix
mode for listening on unix domain dgram socket
.IR /dev/log .
a proper
.I run
file for
.BR supervise (8)
is:
.LP
  #!/bin/sh
  exec 2>&1
  exec envuidgid nobody socklog unix /dev/log
.LP
.I ucspi
mode for listening on unix domain stream socket
.IR /dev/log .
a proper
.I run
file for
.BR supervise (8)
is:
.LP
  #!/bin/sh
  exec 2>&1
  exec unixserver -U `id -u nobody` /dev/log \\
    socklog ucspi UNIXREMOTEEUID UNIXREMOTEEGID
.LP
.I inet
mode for listening on udp network socket
.I 0.0.0.0\fR:\fI514\fR.
a proper
.I run
file for
.BR supervise (8)
is:
.LP
  #!/bin/sh
  exec 2>&1
  exec envuidgid nobody socklog inet 0 514
.LP
.SH SEE ALSO
svscan(8),
supervise(8),
multilog(8),
tryto(1),
uncat(1),
tcpserver(1)
.LP
 http://innominate.org/~pape/socklog/
 http://cr.yp.to/daemontools.html
.SH AUTHOR
Gerrit Pape <pape@smarden.org>
