<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<title>socklog - small and secure replacement for syslogd</title>
</head>
<body>
<a href="http://smarden.org/pape/">G. Pape</a>
<hr>
<h1>socklog - small and secure replacement for <i>syslogd</i></h1>
<hr>
<a href="install.html">How to install socklog</a><br>
<a href="upgrade.html">Upgrading from previous versions of socklog</a><br>
<a href="usedietlibc.html">How to use dietlibc</a>
<p>
<a href="benefits.html">Benefits</a><br>
<a href="configuration.html">Configuration</a><br>
<a href="examples.html">Examples</a><br>
<a href="network.html">Network logging</a><br>
<a href="notify.html">Log events notification</a>
<p>
<a href="socklog-conf.8.html">The <tt>socklog-conf</tt> program</a><br>
<a href="socklog.8.html">The <tt>socklog</tt> program</a><br>
<a href="tryto.1.html">The <tt>tryto</tt> program</a><br>
<a href="uncat.1.html">The <tt>uncat</tt> program</a>
<hr>
<i>socklog</i> in cooperation with djb's
<a href="http://cr.yp.to/daemontools.html">daemontools</a> is a small and
secure replacement for syslogd. There are three main features,
syslogd provides:
<ul>
  <li>
  receiving syslog messages from an unix domain socket
  (<tt>/dev/log</tt>) and writing them to various files on disk
  depending on <tt>facility</tt> and <tt>priority</tt>.
  <li>
  receiving syslog messages from an udp socket
  (<tt>0.0.0.0:514</tt>) and writing them to various files on disk
  depending on <tt>facility</tt> and <tt>priority</tt>.
  <li>
  writing received syslog messages to an udp socket
  (<tt>a.b.c.d:514</tt>)
</ul>
<p>
<i>socklog</i> provides the first two features with the help of
<a href="http://cr.yp.to/daemontools.html">daemontools</a>`
<a href="http://cr.yp.to/daemontools/svscan.html">svscan</a>,
<a href="http://cr.yp.to/daemontools/supervise.html">supervise</a>
and <a href="http://cr.yp.to/daemontools/multilog.html">multilog</a>,
provides a different
<a href="network.html">network logging concept</a> and additionally
does <a href="notify.html">log event notification</a>.
<p>
<a href="http://cr.yp.to/daemontools/multilog.html">multilog</a>
has a built in
<a href="benefits.html#logrotation">logfile rotation based on file size</a>,
so there is no need for any cron jobs or similar to rotate the logs.
Log partitions can be calculated properly.
<p>
<i>socklog</i> runs on linux, glibc 2.1.0 or higher. <i>socklog</i>
reportedly runs on OpenBSD 2.8 and 2.9, FreeBSD and Solaris. If it
runs for you on other operating systems, please let me know.
<p>
<i>socklog</i> is small, secure, reliable.
<hr>
<i>socklog</i> is run under
<a href="http://cr.yp.to/daemontools.html">daemontools</a>'
<a href="http://cr.yp.to/daemontools/supervise.html">supervise</a>,
writing syslog messages it receives from an unix domain
socket <tt>path</tt> (<tt>/dev/log</tt>) or an inet udp socket
<tt>ip:port</tt> (<tt>0.0.0.0:514</tt>) through a pipe
provided by
<a href="http://cr.yp.to/daemontools/svscan.html">svscan</a>
to a <a href="http://cr.yp.to/daemontools/multilog.html">multilog</a>
process.
<p>
<i>socklog</i> can be run as an
<a href="http://cr.yp.to/proto/ucspi.txt">ucspi</a> application to
listen to an unix domain stream socket and for centralized or more
flexible distributed logging (see
<a href="network.html">network logging</a>).
<p>
If <i>socklog</i> listens to an udp socket, it prepends
<tt>ip:</tt> (<tt>a.b.c.d: </tt>) to each syslog message it receives,
where <tt>a.b.c.d</tt> is the ip address of the connecting system.
<p>
If the environment variables $UID and/or $GID are present,
<i>socklog</i> will drop permissions to those ids after creating
and binding to the socket (not in
<a href="http://cr.yp.to/proto/ucspi.txt">ucspi</a> mode).
<p>
<i>socklog</i>  converts syslog <tt>facility</tt> and <tt>priority</tt>
information to names (<tt>facility.priority</tt>) as found in
<tt>/usr/include/syslog.h</tt>
at compile time if present, you can use this for
<a href="http://cr.yp.to/daemontools/multilog.html">multilog</a>'s line
selecting by pattern.
<hr>
A proper <tt>run</tt> file for
<a href="http://cr.yp.to/daemontools/supervise.html">supervise</a> is:
<pre>
  #!/bin/sh
  exec 2>&1
  exec envuidgid nobody socklog unix /dev/log
</pre>
See
<a href="http://cr.yp.to/daemontools/envuidgid.html">envuidgid</a>
(<tt># man envuidgid</tt>) and <a href="socklog.8.html">socklog</a>
(<tt># man socklog</tt>).
<p>
A proper <tt>log/run</tt> file for
<a href="http://cr.yp.to/daemontools/supervise.html">supervise</a>
is:
<pre>
  #!/bin/sh
  LOGDIR=/var/log/socklog
  exec setuidgid log multilog s4999999 n10 ${LOGDIR}/main \
    s999999 n5 -* +kern.* ${LOGDIR}/kern \
    s999999 n5 -* +user.* ${LOGDIR}/user \
    s999999 n5 -* +mail.* ${LOGDIR}/mail \
    s999999 n5 -* +daemon.* ${LOGDIR}/daemon \
    s999999 n5 -* +auth.* +authpriv.* ${LOGDIR}/auth \
    s999999 n5 -* +syslog.* ${LOGDIR}/syslog \
    s999999 n5 -* +news.* ${LOGDIR}/news \
    s999999 n5 -* +cron.* ${LOGDIR}/cron \
    s999999 n5 -* +ftp.* ${LOGDIR}/ftp \
    s999999 n5 -* +local*.* ${LOGDIR}/local \
    s999999 n5 -* +*.debug* ${LOGDIR}/debug
</pre>
See 
<a href="http://cr.yp.to/daemontools/setuidgid.html">setuidgid</a>
(<tt># man setuidgid</tt>) and
<a href="http://cr.yp.to/daemontools/multilog.html">multilog</a>
(<tt># man multilog</tt>).
<hr>
<i>socklog</i> can be discussed on the
<a href="http://cr.yp.to/lists.html#log">log mailing list</a>
owned by D. J. Bernstein about replacements for syslog.
<hr>
<i>socklog</i> is also available as
<a href="http://www.debian.org">Debian GNU/Linux</a> package,
just add
<pre>
  deb http://smarden.org/pape/Debian woody unofficial
  deb-src http://smarden.org/pape/Debian woody unofficial
</pre>
to <tt>/etc/apt/sources.list</tt> and
<pre>
  # apt-get update
</pre>
Then install the package <i>socklog</i> as usual with <tt>apt-get</tt>,
<tt>dpkg</tt> or <tt>dselect</tt>, e.g.:
<pre>
  # apt-get install socklog
</pre>
<hr>
See <a href="install.html">INSTALL</a> on how to install <i>socklog</i>
and <a href=configuration.html>Configuration</a> for setting up
<i>socklog</i> services.
<hr>
See <a href="http://smarden.org/socklog/">
http://smarden.org/socklog/</a>
for recent informations.
<hr>
<address><a href="mailto:pape@smarden.org">
Gerrit Pape &lt;pape@smarden.org&gt;
</a></address>
<small>$Id$</small>
</body>
</html>
