<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
  <head>
    <title>socklog - minimal replacement for syslogd</title>
  </head>
  
  <body>
    <a href="http://innominate.org/~pape/">G. Pape</a>
    <hr>
    <h1>socklog - minimal replacement for <i>syslogd</i></h1>
    <hr>
    <a href="install.html">How to install socklog</a><br><br>

    <a href="benefits.html">Benefits</a><br>
    <a href="configuration.html">Configuration</a><br>
    <a href="examples.html">Examples</a><br>
    <a href="network.html">Network logging</a><br>
    <a href="notify.html">Log events notification</a><br><br>

    <a href="socklog.8.html">The <tt>socklog</tt> program</a><br>
    <a href="tryto.1.html">The <tt>tryto</tt> program</a><br>
    <a href="uncat.1.html">The <tt>uncat</tt> program</a><br><br>

    <hr>
    <i>socklog</i> in cooperation with djb's
    <a href="http://cr.yp.to/daemontools.html">daemontools</a> is a minimal
    replacement for syslogd. There are three main features,
    syslogd provides:
    <ul>
      <li>
	receiving syslog messages from a unix domain socket
	(<tt>/dev/log</tt>) and writing them to various files on disk
	depending on <tt>facility</tt> and <tt>priority</tt>.
      <li>
	receiving syslog messages from an udp socket
	(<tt>0.0.0.0:514</tt>) and writing them to various files on disk
	depending on <tt>facility</tt> and <tt>priority</tt>.
      <li>
	writing received syslog messages to an udp socket
	(<tt>a.b.c.d:514</tt>)
    </ul>
    <p>
      <i>socklog</i> refuses the latter but provides the first two features
      with the help of
      <a href="http://cr.yp.to/daemontools.html">daemontools</a>`
      <a href="http://cr.yp.to/daemontools/svscan.html">svscan</a>,
      <a href="http://cr.yp.to/daemontools/supervise.html">supervise</a>
      and <a href="http://cr.yp.to/daemontools/multilog.html">multilog</a>.
    <p>
      <a href="http://cr.yp.to/daemontools/multilog.html">multilog</a>
      has a built in
      <a href=benefits.html>logfile rotation based on file size</a>,
      so there is no need for any cron jobs or similar to rotate the logs.
    <p>
      <i>socklog</i> runs on linux, glibc 2.1.0 or higher. <i>socklog</i>
      reportedly runs on OpenBSD 2.8, FreeBSD and Solaris. If it runs for
      you on other operating systems, please let me know.
    <p>
      <i>socklog</i> is small, secure, reliable and not feature-overloaded.
    <hr>
    <i>socklog</i> is run under
    <a href="http://cr.yp.to/daemontools.html">daemontools</a>'
    <a href="http://cr.yp.to/daemontools/supervise.html">supervise</a>,
    writing syslog messages it receives from an unix domain
    socket <tt>path</tt> (<tt>/dev/log</tt>) or an inet udp socket
    <tt>ip:port</tt> (<tt>0.0.0.0:514</tt>) through a pipe
    provided by
    <a href="http://cr.yp.to/daemontools/svscan.html">svscan</a>
    to a <a href="http://cr.yp.to/daemontools/multilog.html">multilog</a>
    process.
    <p>
    <i>socklog</i> can be run as an
    <a href="http://cr.yp.to/proto/ucspi.txt">ucspi</a> application to
    listen to an unix domain stream socket and for centralized or more
    flexible distributed logging.
    <p>
    If <i>socklog</i> listens to an udp socket, it prepends
    <tt>ip:</tt> (<tt>a.b.c.d: </tt>) to each syslog message it receives,
    where <tt>a.b.c.d</tt> is the ip address of the connecting system.
    <p>
    If the environment variables $UID and/or $GID are present,
    <i>socklog</i> will drop permissions to those ids after creating
    and binding to the socket (not in
    <a href="http://cr.yp.to/proto/ucspi.txt">ucspi</a> mode).
    <p>
    <i>socklog</i>  converts syslog <tt>facility</tt> and <tt>priority</tt>
    information to names (<tt>facility.priority</tt>) as found in
    <tt>/usr/include/syslog.h</tt>
    at compile time if present, you can use this for
    <a href="http://cr.yp.to/daemontools/multilog.html">multilog</a>'s line
    selecting by pattern.
    <hr>
    A proper <tt>run</tt> file for
    <a href="http://cr.yp.to/daemontools/supervise.html">supervise</a> is:
    <pre>
  #!/bin/sh
  exec 2>&1
  exec envuidgid nobody socklog unix /dev/log
    </pre>
    See
    <a href="http://cr.yp.to/daemontools/envuidgid.html">envuidgid</a>
    (<tt># man envuidgid</tt>) and <tt>socklog</tt>
    (<tt># man socklog</tt>).
    <p>
      A proper <tt>log/run</tt> file for
      <a href="http://cr.yp.to/daemontools/supervise.html">supervise</a>
      is:
    <pre>
  #!/bin/sh
  LOGDIR=/var/log/socklog
  exec setuidgid log multilog s4999999 n10 ${LOGDIR}/main \
    s999999 n5 -* +kern.* ${LOGDIR}/kern \
    s999999 n5 -* +user.* ${LOGDIR}/user \
    s999999 n5 -* +mail.* ${LOGDIR}/mail \
    s999999 n5 -* +daemon.* ${LOGDIR}/daemon \
    s999999 n5 -* +auth.* +authpriv.* ${LOGDIR}/auth \
    s999999 n5 -* +syslog.* ${LOGDIR}/syslog \
    s999999 n5 -* +news.* ${LOGDIR}/news \
    s999999 n5 -* +cron.* ${LOGDIR}/cron \
    s999999 n5 -* +ftp.* ${LOGDIR}/ftp \
    s999999 n5 -* +local*.* ${LOGDIR}/local \
    s999999 n5 -* +*.debug* ${LOGDIR}/debug
    </pre>
    See 
    <a href="http://cr.yp.to/daemontools/setuidgid.html">setuidgid</a>
    (<tt># man setuidgid</tt>) and
    <a href="http://cr.yp.to/daemontools/multilog.html">multilog</a>
    (<tt># man multilog</tt>).
    <hr>
    you can <a href="ftp://ftp.innominate.org/pub/pape/socklog/">download</a>
    the package via ftp. <i>socklog</i> is also available as
    <a href="http://www.debian.org">Debian GNU/Linux</a> package,
    just add
    <pre>
  deb ftp://ftp.innominate.org/pub/pape/Debian woody innominate
  deb-src ftp://ftp.innominate.org/pub/pape/Debian woody innominate
    </pre>
    to <tt>/etc/apt/sources.list</tt> and
    <pre>
  # apt-get update
    </pre>
    Then install the package <i>socklog</i> as usual with <tt>apt</tt>,
    <tt>dpkg</tt> or <tt>dselect</tt>.
    <hr>
    See <a href="install.html">INSTALL</a> on how to install <i>socklog</i>
    and <a href=configuration.html>Configuration</a> for setting up
    <i>socklog</i> services.
    <hr>
    See <a href="/~pape/socklog/">http://innominate.org/~pape/socklog/</a>
    for recent informations.
    <hr>
    <address><a href="mailto:pape@innominate.com">G. Pape</a></address>
    <small>$Id$</small>
  </body>
</html>
