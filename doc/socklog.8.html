


<HTML>
<HEAD>
<TITLE>socklog(8) manual page</TITLE>
</HEAD>
<BODY bgcolor=white>
<a href="http://innominate.org/~pape/">G. Pape</a><br><A HREF="index.html">socklog</A><hr><P>

<H2><A NAME="sect0">Name</A></H2>
socklog - minimal syslogd replacement for use with djb's daemontools

<H2><A NAME="sect1">Synopsis</A></H2>
<B>socklog</B> [ unix ] [ <I>path</I> ] <BR>
<B>socklog</B> inet [ <I>ip</I> ] [ <I>port</I> ] <BR>
<B>socklog</B> ucspi [ <I>args</I> ] 
<H2><A NAME="sect2">Description</A></H2>
<B>socklog</B> is run under daemontools' <B><I>supervise</B>(8)</I>,
writing syslog messages it receives from unix domain socket <I>path</I> or an
inet udp socket <I>ip:<I>port</I></I> through a pipe provided by <B><I>svscan</B>(8)</I> to a <B><I>multilog</B>(8)</I>
process. <P>
<B>socklog</B> can be run as an ucspi application to listen to an unix
domain stream socket and for more flexible distributed logging. <P>
If the environment
variables $UID and/or $GID are present, <B>socklog</B> will drop permissions to
those ids after creating and binding the socket (not in <I>ucspi</I> mode). <P>
<B>socklog</B>
converts syslog facility and priority information to names (<I>facility</I>.<I>priority</I>:)
as found in <I>/usr/include/syslog.h</I> at compile time if present. 
<H2><A NAME="sect3">Unix Socket</A></H2>
<B>socklog</B>
[ unix ] [ <I>path</I> ] <P>
Starting <B>socklog</B> with the 1st argument <I>unix</I>, <B>socklog</B>
will listen to the unix domain socket <I>path</I>. If <I>path</I> is omitted, the default
<I>/dev/log</I> is used. <P>
The 1st argument may be omitted, default is <I>unix</I>. 
<H2><A NAME="sect4">Inet
Socket</A></H2>
<B>socklog</B> inet [ <I>ip</I> ] [ <I>port</I> ] <P>
Starting <B>socklog</B> with the 1st argument
<I>inet</I>, <B>socklog</B> will listen to the inet udp socket <I>ip:<I>port</I>.</I> <P>
If <I>ip</I> starts with
0, <B>socklog</B> will bind to all local interfaces. <P>
If <I>port</I> is less or equal 1024,
<B>socklog</B> must be run by root. <P>
<I>port</I> may be omitted, default is 514. <I>ip</I> may
be omitted, default is 0. <P>
<B>socklog</B> prepends <I>a.b.c.d:</I> to each syslog message
it receives, where <I>a.b.c.d</I> is the ip address of the connecting system. 
<H2><A NAME="sect5">Ucspi
Mode</A></H2>
<B>socklog</B> ucspi [ <I>args</I> ] <P>
Starting <B>socklog</B> with the 1st argument <I>ucspi</I>,
<B>socklog</B> will run as an ucspi application. Normally <B>socklog</B> will only be
started in <I>ucspi</I> mode by an ucspi server tool, such as <B><I>tcpserver</B>(1)</I> or
<B>unixserver</B>. <P>
For each <I>arg</I>, <B>socklog</B> will prepend $<I>arg</I>: to each syslog message,
if the environment variable $<I>arg</I> is present (maximum is 8). <P>
 <P>
 
<H2><A NAME="sect6">Examples</A></H2>
<I>unix</I>
mode for listening on unix domain dgram socket <I>/dev/log</I>. a proper <I>run</I> file
for <B><I>supervise</B>(8)</I> is: <P>
  #!/bin/sh<BR>
   exec 2&gt;&amp;1<BR>
   exec envuidgid nobody socklog unix /dev/log<BR>
 <P>
<I>ucspi</I> mode for listening on unix domain stream socket <I>/dev/log</I>. a proper
<I>run</I> file for <B><I>supervise</B>(8)</I> is: <P>
  #!/bin/sh<BR>
   exec 2&gt;&amp;1<BR>
   exec unixserver -U `id -u nobody` /dev/log \<BR>
     socklog ucspi UNIXREMOTEEUID UNIXREMOTEEGID<BR>
 <P>
<I>inet</I> mode for listening on udp network socket <I>0.0.0.0:<I>514</I>.</I> a proper <I>run</I> file
for <B><I>supervise</B>(8)</I> is: <P>
  #!/bin/sh<BR>
   exec 2&gt;&amp;1<BR>
   exec envuidgid nobody socklog inet 0 514<BR>
 <P>

<H2><A NAME="sect7">See Also</A></H2>
<I>svscan(8)</I>, <I>supervise(8)</I>, <I>multilog(8)</I>, <I>tryto(1)</I>, <I>uncat(1)</I>, <I>tcpserver(1)</I>
<P>
 <I>http://innominate.org/~pape/socklog/</I><BR>
  <I>http://cr.yp.to/daemontools.html</I><BR>
 
<H2><A NAME="sect8">Author</A></H2>
Gerrit Pape &lt;pape@smarden.org&gt; <P>

<HR><P>
<A NAME="toc"><B>Table of Contents</B></A><P>
<UL>
<LI><A NAME="toc0" HREF="#sect0">Name</A></LI>
<LI><A NAME="toc1" HREF="#sect1">Synopsis</A></LI>
<LI><A NAME="toc2" HREF="#sect2">Description</A></LI>
<LI><A NAME="toc3" HREF="#sect3">Unix Socket</A></LI>
<LI><A NAME="toc4" HREF="#sect4">Inet Socket</A></LI>
<LI><A NAME="toc5" HREF="#sect5">Ucspi Mode</A></LI>
<LI><A NAME="toc6" HREF="#sect6">Examples</A></LI>
<LI><A NAME="toc7" HREF="#sect7">See Also</A></LI>
<LI><A NAME="toc8" HREF="#sect8">Author</A></LI>
</UL>
</BODY></HTML>
